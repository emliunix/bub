# Development Journal

## Session: 2026-02-18 - AGENTS.md Cleanup and Project Skills

### Overview
Refactored AGENTS.md to improve agent workflow and created comprehensive project skills for better maintainability. Reduced AGENTS.md from 722 to 575 lines while adding 4 new skills with detailed documentation.

---

## Changes Made

### 1. AGENTS.md Restructuring

**Moved Subagent Workflow to Top**
- Placed right after Workflow Warm Up section
- Makes the subagent coordination pattern immediately visible

**Deleted Code Review Findings Section**
- Removed 149 lines of historical code review notes
- These were refactoring TODOs, not actionable agent guidelines
- Content extracted to project skills where relevant

**Added "Using Project Skills" Section**
- Created anti-patterns table showing what NOT to do vs which skill to use
- Added skill-first workflow guidance
- Instructions to update skills when information is missing

### 2. Created Project Skills (`.agent/skills/`)

#### bus-cli/SKILL.md
- WebSocket Message Bus CLI commands
- Quick start guide for `bub bus` subcommand
- Architecture overview

#### deployment/SKILL.md
- Systemd-based production deployment
- Component descriptions with purpose (not just labels)
- Command pattern: `./scripts/deploy-production.sh <action> <component>`
- All 4 components documented: bus, agent, tape, telegram-bridge

#### docs/SKILL.md
- Comprehensive MkDocs documentation guide
- **Critical formatting rules**:
  - Tables MUST have blank lines before them
  - Mermaid diagrams MUST be validated with `scripts/validate_mermaid.py`
- Writing guidelines for callouts and code blocks
- Project structure documentation
- Pre-commit checklist

#### testing/SKILL.md
- Test script catalog organized by category
- MiniMax API testing scripts
- Bub integration testing scripts
- Bus testing scripts
- Environment setup requirements

### 3. Created docs/components.md

**New comprehensive component documentation:**
- Architecture diagram showing relationships
- Detailed documentation for each component:
  - **Bus** - Message router (port 7892)
  - **Agent** - AI worker process
  - **Tape** - REST API for conversation storage (port 7890)
  - **Telegram Bridge** - Telegram Bot API connector
- Component dependencies and startup order
- Quick reference table
- Troubleshooting guide

### 4. Updated docs/index.md

- Added link to new [Components](components.md) documentation
- Placed in "Start Here" section for visibility

---

## File Changes

| File | Lines Changed | Description |
|------|---------------|-------------|
| AGENTS.md | -147 (722→575) | Restructured, removed Code Review Findings, added skill references |
| docs/components.md | +183 | New comprehensive component documentation |
| docs/index.md | +1 | Added components link |
| .agent/skills/bus-cli/SKILL.md | +52 | WebSocket bus commands skill |
| .agent/skills/deployment/SKILL.md | +77 | Production deployment skill |
| .agent/skills/docs/SKILL.md | +210 | Documentation system skill |
| .agent/skills/testing/SKILL.md | +82 | Test scripts skill |

**Total**: 7 files changed, 835 insertions(+), 329 deletions(-)

---

## Key Improvements

### Skill-First Workflow
Instead of embedding detailed commands in AGENTS.md:
- AGENTS.md says: "Check `docs` skill first"
- docs/SKILL.md contains: All MkDocs setup, validation scripts, writing guidelines

This follows the principle: **AGENTS.md = what to do, Skills = how to do it**

### Documentation Quality Standards
- **Tables**: Must have blank lines preceding (documented in docs skill)
- **Mermaid diagrams**: Must be validated with `scripts/validate_mermaid.py`
- **Callouts**: Use admonitions for important notes
- **Code blocks**: Always use language identifiers

### Component Clarity
Previously: "telegram-bridge - Telegram Bot API bridge [planned]"

Now: "telegram-bridge - Telegram Bot API bridge - connects Telegram to the bus as JSON-RPC client"

Each component now explains **what it does**, not just what it is.

---

## Verification

**Skill Discovery Confirmed:**
```
.agent/skills/
├── bus-cli/SKILL.md      ✓
├── deployment/SKILL.md   ✓
├── docs/SKILL.md         ✓
└── testing/SKILL.md      ✓
```

**Global Skills Available:**
- `python-uv` - UV package manager
- `python-project` - UV project management
- `skill-creator` - Create new skills
- `skill-install` - Install skills

**Alignment Check:**
- docs skill uses `uv run mkdocs serve` ✓ (matches python-uv skill)
- pyproject.toml has mkdocs in dev dependency group ✓ (matches python-project skill)

---

## Lessons Learned

1. **Separate concerns**: AGENTS.md for workflow, skills for implementation details
2. **Skills evolve**: When info is missing, update SKILL.md not AGENTS.md
3. **Anti-patterns help**: Clear table showing what NOT to do prevents mistakes
4. **Component descriptions matter**: "What it does" > "What it is"

---

## Follow-up Actions

### Completed ✅
- Restructured AGENTS.md (Subagent Workflow at top)
- Deleted Code Review Findings section
- Created 4 project skills (bus-cli, deployment, docs, testing)
- Created docs/components.md
- Updated docs/index.md
- Verified skill alignment with global python-uv/python-project skills
- Committed changes (30e06fa)

### TODO
- [ ] Add more examples to skills as they are used
- [ ] Consider creating skill for common tape operations
- [ ] Document mermaid diagram conventions in docs/skill
- [ ] Add troubleshooting section to each skill based on real issues

---

## Related Documents

- AGENTS.md - Main agent guidelines (now 575 lines)
- docs/components.md - Detailed component documentation
- .agent/skills/*/SKILL.md - 4 new project skills
- docs/index.md - Updated with components link

---

## Commit Reference

```
30e06fa refactor: reorganize AGENTS.md and add project skills

- Move Subagent Workflow to top of AGENTS.md
- Remove Code Review Findings section (149 lines deleted)
- Add 'Using Project Skills' section with anti-patterns table
- Create .agent/skills/ with 4 skills
- Create docs/components.md for detailed component docs
- Update docs/index.md to link to components.md
- Extract detailed content from AGENTS.md to skills/docs
- Document table formatting and mermaid validation rules
```
